(function(){var a=document.getElementsByTagName("script");var b=a[a.length-1].src;angular.module("acAutocomplete",["ngRoute"]).component("acAutocomplete",{bindings:{searchFunction:"&",searchFields:"=",fieldsToShow:"=",selectedTo:"=",href:"=",exact:"="},template:'<input type="text" id="ac-autocomplete-{{$ctrl.id}}" ng-change="$ctrl.getList();" ng-model="$ctrl.searchText" autocomplete="off">',controller:c});c.$inject=["$element","$scope","$compile","$timeout","AcUtils"];function c(p,o,j,h,i){var g=this;g.id=o.$id;g.indexSelected=-1;g.searchText="";g.cacheList=[];g.filteredList=[];g.camposAComparar=(g.searchFields)?g.searchFields.split(","):[];g.camposAMostrar=(g.fieldsToShow)?g.fieldsToShow.split(","):[];g.exacto=(g.exact)?g.exact:false;g.getList=k;g.select=m;function k(){if(g.cacheList==undefined||g.cacheList.length==0){g.searchFunction({callback:function(q){g.cacheList=q;e()}})}else{e()}}function e(){if(g.cacheList!=undefined){g.filteredList=[];g.cacheList.filter(function(s,r,q){g.camposAComparar.forEach(function(u,t,v){if(!g.filteredList.hasOwnProperty(r)){if(s[u]!=null&&((g.exacto&&s[u].toUpperCase()==g.searchText.toUpperCase())||(!g.exacto&&s[u].toUpperCase().indexOf(g.searchText.toUpperCase())>-1))){return g.filteredList[r]=s}}})});n()}}function n(){var q=document.getElementById("ac-autocomplete-panel-"+g.id);if(q!=null){q.remove()}var r="";if(g.filteredList.length>0&&g.searchText.trim().length>0){g.filteredList.forEach(function(u,t,s){r=r+'<li ng-click="$ctrl.select('+t+')" ng-mouseover="$ctrl.select('+t+")\" ng-class=\"{'ac-autocomplete-selected':$ctrl.indexSelected=='"+t+"'}\">";g.camposAMostrar.forEach(function(y,x,A){if(y.indexOf("[")>-1){var w=y.split(".");var z=w[0].replace("]","").substr(y.indexOf("[")+1);var v=w[0].substr(0,y.indexOf("["));r=r+"<span>"+u[v][z][w[1]]+"</span> "}else{r=r+"<span>"+u[y]+"</span> "}});r=r+"</li>"});p.append(j('<ul class="ac-autocomplete-panel" id="ac-autocomplete-panel-'+g.id+'">'+r+"</ul>")(o));m(Object.keys(g.filteredList)[0])}else{m(-1)}}function m(q){h(function(){if(q==-1){g.selectedTo={}}else{g.selectedTo=g.filteredList[q]}g.indexSelected=q},0)}p.children().bind("blur",function(){l()});p.bind("keyup focus",function(r){if(r.keyCode==40){var q=d(g.indexSelected);g.indexSelected=(q.nextIndex==undefined)?q.firstIndex:q.nextIndex;m(g.indexSelected);f()}if(r.keyCode==38){var q=d(g.indexSelected);g.indexSelected=(q.prevIndex==undefined)?q.lastIndex:q.prevIndex;m(g.indexSelected);f()}if(r.keyCode==13){l()}});function l(){if(g.searchText==undefined||g.searchText.trim().length==0||g.filteredList.length==0){m(-1)}else{m(g.indexSelected);g.searchText=g.selectedTo[g.camposAMostrar[0]]}var q=document.getElementById("ac-autocomplete-panel-"+g.id);if(q!=null){q.remove()}}function f(){var q=g.searchText;g.searchText="";h(function(){g.searchText=q},0)}function d(w){var u=Object.keys(g.filteredList);var t=u.indexOf(w);var q=u[t+1];var s=u[t-1];var r=u[0];var v=u[u.length-1];return{nextIndex:q,prevIndex:s,firstIndex:r,lastIndex:v}}}})();