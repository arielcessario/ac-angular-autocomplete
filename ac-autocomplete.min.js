(function(){var a=document.getElementsByTagName("script");var b=a[a.length-1].src;angular.module("acAutocomplete",["ngRoute"]).component("acAutocomplete",{bindings:{searchFunction:"&",searchFields:"=",fieldsToShow:"=",selectedTo:"=",href:"=",exact:"="},template:'<input type="text" id="ac-autocomplete-{{$ctrl.id}}" ng-change="$ctrl.getList();" ng-model="$ctrl.searchText">',controller:c});c.$inject=["$element","$scope","$compile","$timeout"];function c(o,n,i,h){var g=this;g.id=n.$id;g.indexSelected=-1;g.searchText="";g.cacheList=[];g.filteredList=[];g.camposAComparar=(g.searchFields)?g.searchFields.split(","):[];g.camposAMostrar=(g.fieldsToShow)?g.fieldsToShow.split(","):[];g.exacto=(g.exact)?g.exact:false;g.getList=j;g.select=l;function j(){if(g.cacheList!==undefined&&g.cacheList.length==0){g.searchFunction({callback:function(p){g.cacheList=p;e()}})}else{e()}}function e(){if(g.cacheList!=undefined){g.filteredList=[];g.cacheList.filter(function(r,q,p){g.camposAComparar.forEach(function(t,s,u){if(!g.filteredList.hasOwnProperty(q)){if((g.exacto&&r[t].toUpperCase()==g.searchText.toUpperCase())||(!g.exacto&&r[t].toUpperCase().indexOf(g.searchText.toUpperCase())>-1)){return g.filteredList[q]=r}}})});m()}}function m(){var p=document.getElementById("ac-autocomplete-panel-"+g.id);if(p!=null){p.remove()}var q="";if(g.filteredList.length>0&&g.searchText.trim().length>0){g.filteredList.forEach(function(t,s,r){q=q+'<li ng-click="$ctrl.select('+s+')" ng-mouseover="$ctrl.select('+s+")\" ng-class=\"{'ac-autocomplete-selected':$ctrl.indexSelected=='"+s+"'}\">";g.camposAMostrar.forEach(function(v,u,w){q=q+"<span>"+t[v]+"</span> "});q=q+"</li>"});o.append(i('<ul class="ac-autocomplete-panel" id="ac-autocomplete-panel-'+g.id+'">'+q+"</ul>")(n));l(Object.keys(g.filteredList)[0])}else{l(-1)}}function l(p){h(function(){if(p==-1){g.selectedTo={}}else{g.selectedTo=g.filteredList[p]}g.indexSelected=p},0)}o.children().bind("blur",function(){k()});o.bind("keyup focus",function(q){if(q.keyCode==40){var p=d(g.indexSelected);g.indexSelected=(p.nextIndex==undefined)?p.firstIndex:p.nextIndex;l(g.indexSelected);f()}if(q.keyCode==38){var p=d(g.indexSelected);g.indexSelected=(p.prevIndex==undefined)?p.lastIndex:p.prevIndex;l(g.indexSelected);f()}if(q.keyCode==13){k()}});function k(){if(g.searchText.trim().length==0||g.filteredList.length==0){l(-1)}else{l(g.indexSelected);g.searchText=g.selectedTo[g.camposAMostrar[0]]}var p=document.getElementById("ac-autocomplete-panel-"+g.id);if(p!=null){p.remove()}}function f(){var p=g.searchText;g.searchText="";h(function(){g.searchText=p},0)}function d(v){var t=Object.keys(g.filteredList);var s=t.indexOf(v);var p=t[s+1];var r=t[s-1];var q=t[0];var u=t[t.length-1];return{nextIndex:p,prevIndex:r,firstIndex:q,lastIndex:u}}}})();